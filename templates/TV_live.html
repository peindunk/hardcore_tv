<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0,
         minimum-scale=0.5, maximum-scale=2.0, user-scalable=yes" />
        <title>TV_live</title>
        <link rel="shortcut icon" href="{{ url_for('static',filename='img/logo.jpg') }}">
        <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='css/TV_live.css') }}">
        <link rel="stylesheet" href="{{ url_for('static',filename='css/Head.css') }}" type="text/css">
        <script type="text/javascript" src="{{ url_for('static',filename='js/jquery-1.11.3.js') }}"></script>
        <script src="{{ url_for('static',filename='js/ckplayer/ckplayer/ckplayer.js') }}"></script>
    </head>
    <body>
        <div id="header" >
    <a class="head_logo_hc" href="javascript:location.reload();" style="background: rgba(0, 0, 0, 0)
    no-repeat scroll left center;">
        <img id="homelogo" src="{{ url_for('static',filename='img/file/Hardcore.png') }}">
    </a>
    <ul class="head_nav">
        <li class="nav_current">
            <!--<a href="javascript:location.reload();">é¦–é¡µ</a>-->
            <a href="/">é¦–é¡µ</a>
        </li>
        <li class="nav_total">
            <!--<a href="javascript:location.reload();">å…¨éƒ¨</a>-->
            <a href="/list/all/1">å…¨éƒ¨</a>
        </li>
        <li class="nav_classification">
            <a href="javascript:location.reload();">åˆ†ç±»</a>
            <div class="a_pop open">
                <ul class="second_menu">
                    <li><a href="/list/pcgame/1">PCæ¸¸æˆ</a></li>
                    <li><a href="/list/vgame/1">ä¸»æœºæ¸¸æˆ</a></li>
                    <li><a href="/list/mgame/1">æ‰‹æœºæ¸¸æˆ</a></li>
                    <li><a href="/list/enjoy/1">å¨±ä¹</a></li>
                    <li><a href="/list/other/1">å…¶å®ƒ</a></li>
                </ul>
            </div>

        </li>
        <li class="nav_ad">
            <a href="/ads">å¹¿å‘Š</a>
        </li>
        <li class="nav_aboutUs">
            <a href="/aboutus" target="_blank">å…³äºæˆ‘ä»¬</a>
        </li>
    </ul>
    <form class="in_header_right" method="post" action="/list/search/1">
        <input id="suggest_search" name="search" class="search" type="text" autocomplete="off" value="" placeholder="æœæ¸¸æˆ/ä¸»æ’­" style="position: absolute;left: 20px;">
        <a id="p_search" href="" style="left: 240px;">
            <img src="{{ url_for('static',filename='img/search.png') }}">
        </a>
        {% if not session.get('is_login') %}
        <span id="log_regis">
            <img class="person" src="{{ url_for('static',filename='img/person.png') }}">
            <a id="login" href="/login" rel="nofollow">ç™»å½•</a>
            <span id="sep">|</span>
            <a id="register" href="/register">æ³¨å†Œ</a>
        </span>
        {% elif session.get('is_login') %}
        <span class="nav_user success_login">
            <img id="login_user" src="{{ url_for('static',filename='img/user.jpg') }}" alt="å¤´åƒ" style="width: 26px;height: 26px;border-radius: 13px;">
            &nbsp;&nbsp;
            <div class="user_position" style="height: 29px;line-height: 10px;line-height: 29px;float: right;">
                <span id="login_userName">{{ user.user_name }}</span>
                <span><a href="/skip/logout" style="text-decoration: none">é€€å‡º</a></span>
                &nbsp;&nbsp;&nbsp;
                <span id="showbp">å½“å‰ç§¯åˆ†:{{ score }}</span>
            </div>
        </span>
            <script>

            </script>
        {% endif %}
    </form>
</div>
        <div id="roomname">
            <span class="roomtitle">{{ info['room_name'] }}</span>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <span class="roominfo">||{{ info['type'] }}</span>
        </div>
        <div id="attention">
            <button class="try" onclick="at()">è®¢é˜…</button>
            <button class="num">{{ info['fans'] }}å…³æ³¨</button>
            <script type="text/javascript">
                function at(){
                    if ($("#attention .try").text()=="è®¢é˜…"){
                        var x=confirm("æ˜¯å¦è®¢é˜…ï¼Ÿ");
                        if (x==true){
                            $("#attention .try").text("å·²è®¢é˜…");
                            var b=parseInt($("#attention .num").text());
                            var b=b+1;
                            var q=b.toString();
                            $("#attention .num").text(q+"å…³æ³¨");
                        }
                    }else if($("#attention .try").text()=="å·²è®¢é˜…"){
                        var y=confirm("æ˜¯å¦å–æ¶ˆè®¢é˜…ï¼Ÿ");
                        if(y==true){
                            $("#attention .try").text("è®¢é˜…");
                            var b=parseInt($("#attention .num").text());
                            var b=b-1;
                            var q=b.toString();
                            $("#attention .num").text(q+"å…³æ³¨");
                        }
                    }
                }
            </script>
        </div>
        <div id="starframe">
            <div class="starpic">
                <img src={{ info["himg"] }} style='width:55px;'>
                {{ info['host_name'] }}
            </div>
        </div>
        <div class="video" width="1244px" height="700px">
            <script type="text/javascript" src="{{ url_for('static',filename='js/ckplayer/ckplayer/ckplayer.js') }}"></script>
            <div class="vid" width="1244px" height="700px"></div>
            <script type="text/javascript">
                var videoObject = {
                    container: '.vid',//â€œ#â€ä»£è¡¨å®¹å™¨çš„IDï¼Œâ€œ.â€æˆ–â€œâ€ä»£è¡¨å®¹å™¨çš„class
                    variable: 'player1',//è¯¥å±æ€§å¿…éœ€è®¾ç½®ï¼Œå€¼ç­‰äºä¸‹é¢çš„new chplayer()çš„å¯¹è±¡
                    autoplay: true,
                    html5m3u8: true,
                    rtmpBufferTime:10,
                    video: '{{ info['live_url'] }}'
                };
                var player1 = new ckplayer(videoObject);
            </script>
            <div class="barrage-container-wrap clearfix">
                <div class="barrage-container">
                </div>
            </div>
        </div>
        <div class="comment">
            <div class="present">
                <button class="img-group" id="llg" onclick=""><img title="æ–‘ç«¹0p" src="{{ url_for('static',filename='img/p1.png') }}">
                    <div class="img-tip">æ–‘ç«¹5p</div>
                </button>
                <button class="img-group" id="lg" onclick=""><img title="é£æœº10p" src="{{ url_for('static',filename='img/p2.png') }}">
                    <div class="img-tip">é£æœº10p</div>
                </button>
                <button class="img-group" id="mg" onclick=""><img title="ç«ç®­50p" src="{{ url_for('static',filename='img/p3.png') }}">
                    <div class="img-tip">ç«ç®­50p</div>
                </button>
                <button class="img-group" id="hg" onclick=""><img title="è¶…çº§ç«ç®­100p" src="{{ url_for('static',filename='img/p4.png') }}">
                    <div class="img-tip">è¶…çº§ç«ç®­100p</div>
                </button>
            </div>
            <button id="btn"  onclick="location.href='/ads'">è·å–ç§¯åˆ†</button>
        </div>
        <script>

            $(function () {
            $('#llg').click(function () {
                {% if not session.get('is_login') %}
                alert('è¯·ç™»é™†--é€ç¤¼ç‰©')
                {% else %}
                var data = {'bp':-5};
                var s = $('#showbp').text()
                arrlist = s.split(':')
                    $.ajax(
                    {
                        url:'/bp',
                        type:'POST',
                        contentType: 'application/json; charset=UTF-8',
                        dataType:'json',
                        data:JSON.stringify(data),

                    }
            )
                score = parseInt(arrlist[1])
                score -= 5
                if (score<0){
                    alert('æ‚¨çš„ç§¯åˆ†ä¸è¶³ è¯·åœ¨å¹¿å‘Šé¡µé¢è·å–ç§¯åˆ†')
                }
                else {
                    $('#showbp').html('å½“å‰ç§¯åˆ†:' + score)
                    alert('ç»™ä¸»æ’­é€å‡ºæ–‘ç«¹-5åˆ†')
                }
                {% endif %}
            })
        })
            $(function () {
            $('#lg').click(function () {
                {% if not session.get('is_login') %}
                alert('è¯·ç™»é™†--é€ç¤¼ç‰©')
                {% else %}
                var data = {'bp':-10};
                $.ajax(
                {
                    url:'/bp',
                    type:'POST',
                    contentType: 'application/json; charset=UTF-8',
                    dataType:'json',
                    data:JSON.stringify(data),

                }
            )
                var s = $('#showbp').text()
                arrlist = s.split(':')
                score = parseInt(arrlist[1])
                score -= 10
                if (score<0){
                    alert('æ‚¨çš„ç§¯åˆ†ä¸è¶³ è¯·åœ¨å¹¿å‘Šé¡µé¢è·å–ç§¯åˆ†')
                }
                else {
                    $('#showbp').html('å½“å‰ç§¯åˆ†:' + score)
                    alert('ç»™ä¸»æ’­é€å‡ºé£æœº-10åˆ†')
                    $('#plane').css('display','inline')
                    setTimeout(function(){
                    $("#plane").css("display","none");
                        },
                        3000);
                }
                {% endif %}
            })
        })
            $(function () {
            $('#mg').click(function () {
                {% if not session.get('is_login') %}
                alert('è¯·ç™»é™†--é€ç¤¼ç‰©')
                {% else %}
                var data = {'bp':-50};
                $.ajax(
                {
                    url:'/bp',
                    type:'POST',
                    contentType: 'application/json; charset=UTF-8',
                    dataType:'json',
                    data:JSON.stringify(data),

                }

            )
                var s = $('#showbp').text()
                arrlist = s.split(':')
                score = parseInt(arrlist[1])
                score -= 50
                if (score<0){
                    alert('æ‚¨çš„ç§¯åˆ†ä¸è¶³ è¯·åœ¨å¹¿å‘Šé¡µé¢è·å–ç§¯åˆ†')
                }
                else {
                    $('#showbp').html('å½“å‰ç§¯åˆ†:' + score)
                    alert('ç»™ä¸»æ’­é€å‡ºç«ç®­-50åˆ†')
                    $('#rocket').css('display','inline')
                    setTimeout(function(){
                    $("#rocket").css("display","none");
                        },
                        3000);
                }
                {% endif %}
            })
        })
            $(function () {
            $('#hg').click(function () {
                {% if not session.get('is_login') %}
                alert('è¯·ç™»é™†--é€ç¤¼ç‰©')
                {% else %}
                var data = {'bp':-100};
                $.ajax(
                {
                    url:'/bp',
                    type:'POST',
                    contentType: 'application/json; charset=UTF-8',
                    dataType:'json',
                    data:JSON.stringify(data),

                }

            )
                var s = $('#showbp').text()
                arrlist = s.split(':')
                score = parseInt(arrlist[1])
                score -= 100
                if (score<0){
                    alert('æ‚¨çš„ç§¯åˆ†ä¸è¶³ è¯·åœ¨å¹¿å‘Šé¡µé¢è·å–ç§¯åˆ†')
                }
                else {
                    $('#showbp').html('å½“å‰ç§¯åˆ†:' + score)
                    alert('ç»™ä¸»æ’­é€å‡ºè¶…çº§ç«ç®­-100åˆ†')
                    $('#superrocket').css('display','inline')
                    setTimeout(function(){
                    $("#superrocket").css("display","none");
                        },
                        3000);
                }
                {% endif %}
            })
        })
        </script>

        <div class="chat">
            <img src="http://gfs-op.douyucdn.cn/dygift/1606/93daef170894a9d6bd8495fa0f81e165.gif" style="width: 300px; height: 300px; margin-left: 50px; display: none;" id="plane">
            <img src="http://gfs-op.douyucdn.cn/dygift/1606/39b578b3cb8645b54f9a1001c392a237.gif" style="width: 300px; height: 300px; margin-left: 50px; display: none;" id="rocket">
            <img src="http://gfs-op.douyucdn.cn/dygift/1707/c3f3f69e1fdc4f9b2c02a7bcd30334eb.gif" style="width: 300px; height: 300px; margin-left: 50px; display: none;" if="superrocket">
        </div>
        <div class="sendcom">
            <input class="input" type="text" name="sendcom" placeholder="å‘é€è¯„è®º...">
            <span class="send-btn">å‘é€</span>
        </div>
    </body>
    <script>
    ;(function(){
      var barrageArray = [
            'å®‰é™çˆ±éªšç™½å·²ç»åˆ°äº†ä¸€ç§å¢ƒç•Œäº† ','åä¸€æ³¢','ğŸ“º','ç¬é—´çˆ†ç‚¸','å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ','','ä¸æ˜¯åªæœ‰ä¸¤ä¸ªè¿èƒœå·å—ï¼Ÿ','ğŸ’ƒğŸ’ƒğŸ’ƒğŸ’ƒğŸ’ƒğŸ’ƒğŸ’ƒğŸ’ƒğŸ’ƒğŸ’ƒ','ğŸ§ğŸ°ğŸ±ğŸ²ğŸ³ğŸµâ˜•ğŸ¶ğŸºğŸºğŸ»ğŸ¸','å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ','ó¾“­ó¾“­ó¾“­ó¾“­ó¾“­ó¾“­ó¾“­ó¾“­ó¾“­ó¾“­ó¾“­ã€‚','æƒ¨å« å¬åˆ°äº†2å£°æƒ¨å«'
          ,'ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚','â†’_â†’ï¼ˆâ—â€”â—)ï¼ˆâ—â€”â—)ï¼ˆâ—â€”â—ï¼ˆâ—â€”â—)ï¼ˆâ—â€”â—','å—','åŠ æ²¹åŠ æ²¹åŠ æ²¹','äº¤ä¸‹å…è´¹çš„è§å…‰æ£’å“¦ ç„¶åæ²¡å…³æ³¨çš„ç‚¹ä¸‹å…³æ³¨','è°¢è°¢å¤§å®¶æ”¯æŒæ²¡å…³æ³¨ä¸»æ’­çš„å…³æ³¨ä¸€ä¸‹å“¦ï¼Œæ¬¢è¿åŠ å…¥ç²‰ä¸å›¢ï¼Œæˆä¸ºç™½å®¶çš„å°å¯çˆ±è°¢è°¢â¤ï¸','æ»šæ»šæ»š','ğŸ“…ğŸ“…ğŸ“…ğŸ“…ğŸ“…ğŸ“…ğŸ“…ğŸ“…ğŸ“…ğŸ“…',
          'ğŸŒ ğŸŒ ğŸŒ ğŸŒ ğŸŒ ğŸŒ ğŸŒ','ğŸ’›ğŸ’˜ğŸ’ğŸ’ğŸ’˜','å¤–å·æ²¡èµ¢è¿‡','éƒ­æ˜¾å…µå¸®æˆ‘å¼€é—¨','å…³æ³¨æ€ä¹ˆå›äº‹','æ²¡èµ¢è¿‡ï¼Œæˆ‘è§‰å¾—å°±æ˜¯ç«‹é©¬ç‚¹å¡”','ğŸ®ğŸ®ğŸ®ğŸ®ğŸ®ğŸ®ğŸ®ğŸ®ğŸ®ğŸ®ğŸ®','ğŸ’©ğŸ’©ğŸ’©ğŸ’©ğŸ’©ğŸ’©','ğŸï¸ğŸï¸ğŸï¸ğŸï¸ğŸï¸ğŸï¸ğŸ','ã€‚ã€‚ã€‚ã€‚ã€‚','æŠ±æ­‰å…ˆåƒä¸ªé…¸æ¢…','æœ‰å“ªä½å…„å¼Ÿä¹Ÿåœ¨çœ‹çŸ¥å¦çš„','20ç§’','å¯¹é¢æ…Œå¾—ä¸€æ‰¹','éªšè¯å¤ªå¤šå°±å®¹æ˜“æ­»å•Š','ğŸ','æ­»äº†æ€€å­•',
          'ğŸ·ğŸ·ğŸ·ğŸ·ğŸ·ğŸ·ğŸ·ğŸ·','å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ','10ç§’','0. 0','è¢å¯Œè¡Œï¼Œåˆ«çœ‹äº†','èµ¢äº†[emot:dy115]','è¿˜ä¸å¦‚ç‚¹å¡”','ğŸƒğŸƒğŸƒğŸƒğŸƒğŸƒğŸƒğŸƒğŸƒ','uhu8h...','å¤§å‚»å­','æ‰¾ä½ å¦ˆå€Ÿå£','å¥½åƒæ˜¯åªæœ‰è‹¹æœæ‰‹æœºæ‰èƒ½æ‰“å‡ºğŸ‘‘å§å®‰å“å’Œç”µè„‘åˆ«è¯•',' éª‚ä½ ','ç¨³é‡ç‚¹','çœŸçš„å¾ˆæ€§æ„Ÿå˜›ï¼Ÿ','ğŸï¸ğŸï¸ğŸï¸ğŸï¸ğŸï¸ğŸï¸ğŸï¸'
          ,'æˆ‘èµ°äº†','ååˆ€æ°´æ™¶','æ–‡ä½“ä¸¤å¼€èŠ±ï¼Œè¯·å¤šå¤š','ğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒ','ğŸ€ğŸ€ğŸ€ğŸ€ğŸ€ğŸ€ğŸ€ğŸ€ğŸ€ğŸ€ğŸ€','æ›¹æ“é“­æ–‡','è°è¯´æ‰‹æœºä¸è¡Œ','âŒğŸ‘ƒâŒğŸ‘ƒâŒğŸ‘ƒâŒğŸ‘ƒâŒğŸ‘ƒ','ğŸ•ğŸ•ğŸ±ğŸ¶ğŸˆğŸ’ğŸ¦ğŸ¶ğŸƒğŸ•','MVPæ²¡äº†','å¥½åƒæ²¡èµ¢è¿‡ä¸€æ ·','ğŸğŸğŸğŸğŸğŸğŸğŸğŸğŸ','','å°±æ˜¯æƒ³åƒé…¸æ¢…','ğŸ™ˆğŸ™ˆğŸ™ˆğŸ™ˆğŸ™ˆğŸ™ˆğŸ™ˆğŸ™ˆğŸ™ˆğŸ™ˆ','å¯¹é¢å‚æ­»æŒ£æ‰','ğŸğŸŠğŸ‰ğŸˆğŸ¥­',
          ];
      var barrageColorArray = [
        '#0099CC','#333333', '#009966','#FFFF66','#9933FF'
      ];
      var barrageTipWidth = 50; //æç¤ºè¯­çš„é•¿åº¦

      var barrageBoxWrap = document.querySelector('.barrage-container-wrap');;
      var barrageBox = document.querySelector('.barrage-container');
      var inputBox = document.querySelector('.input');
      var sendBtn = document.querySelector('.send-btn');

      //å®¹å™¨çš„å®½é«˜åº¦
      var barrageWidth = ~~window.getComputedStyle(barrageBoxWrap).width.replace('px','');
      var barrageHeight = ~~window.getComputedStyle(barrageBoxWrap).height.replace('px','');

      //å‘é€
      function sendMsg(){
          {% if not session.get('is_login') %}
            alert('è¯·ç™»é™†å‘é€å¼¹å¹•')
          {% else %}
        var inputValue = inputBox.value;
        inputValue .replace(/\ +/g, "");

        if (inputValue.length <= 0) {
            alert('è¯·è¾“å…¥');
            return false;
        }

        //ç”Ÿæˆå¼¹å¹•
        createBarrage(inputValue,true);
        $(".chat").append("<div class='smallcomment'>"+"{{ user.user_name }}"+" : "+inputBox.value+"</div>");
        inputBox.value = '';
          {% endif %}
      }


      //åˆ›å»ºå¼¹å¹•
      function createBarrage(msg, isSendMsg){
        var divNode = document.createElement('div');
        var spanNode = document.createElement('span');

        divNode.innerHTML = msg;
        divNode.classList.add('barrage-item');
        barrageBox.appendChild(divNode);

        spanNode.innerHTML = 'ä¸¾æŠ¥';
        spanNode.classList.add('barrage-tip');
        divNode.appendChild(spanNode);

        barrageOffsetLeft = getRandom(barrageWidth, barrageWidth*2);
        barrageOffsetLeft = isSendMsg ? barrageWidth : barrageOffsetLeft
        barrageOffsetTop = getRandom(10, barrageHeight-10);
        barrageColor = barrageColorArray[Math.floor(Math.random()*(barrageColorArray.length))];

        //æ‰§è¡Œåˆå§‹åŒ–æ»šåŠ¨
        initBarrage.call(divNode,{
          left : barrageOffsetLeft,
          top : barrageOffsetTop,
          color : barrageColor
        });
      }

      //åˆå§‹åŒ–å¼¹å¹•ç§»åŠ¨(é€Ÿåº¦ï¼Œå»¶è¿Ÿ)
      function initBarrage(obj) {
        //åˆå§‹åŒ–
        obj.top = obj.top || 0;
        obj.class = obj.color || '#fff';
        this.style.left = obj.left + 'px';
        this.style.top = obj.top + 'px';
        this.style.color = obj.color;

        //æ·»åŠ å±æ€§
        this.distance = 0;
        this.width = ~~window.getComputedStyle(this).width.replace('px','');
        this.offsetLeft = obj.left;
        this.timer = null;

        //å¼¹å¹•å­èŠ‚ç‚¹
        var barrageChileNode = this.children[0];
        barrageChileNode.style.left = (this.width-barrageTipWidth)/2 + 'px';

        //è¿åŠ¨
        barrageAnimate(this);

        //åœæ­¢
        this.onmouseenter = function(){
          barrageChileNode.style.display= 'block';
          cancelAnimationFrame(this.timer);
        };

        this.onmouseleave = function(){
          barrageChileNode.style.display = 'none';
          barrageAnimate(this);
        };

        //ä¸¾æŠ¥
        barrageChileNode.onclick = function(){
          alert('ä¸¾æŠ¥æˆåŠŸ');
        }
      }

      //å¼¹å¹•åŠ¨ç”»
      function barrageAnimate(obj){
        move(obj);

        if(Math.abs(obj.distance) < obj.width+obj.offsetLeft){
          obj.timer = requestAnimationFrame(function(){
            barrageAnimate(obj);
          });
        }else{
          cancelAnimationFrame(obj.timer);
          //åˆ é™¤èŠ‚ç‚¹
          obj.parentNode.removeChild(obj);
        }
      }

      //ç§»åŠ¨
      function move(obj){
        obj.distance--;
        obj.style.transform = 'translateX('+obj.distance+'px)';
        obj.style.webkitTransform = 'translateX('+obj.distance+'px)';
      }

      //éšæœºè·å–é«˜åº¦
      function getRandom(start, end){
        return start +(Math.random() * (end - start));
      }


      /*******åˆå§‹åŒ–äº‹ä»¶**********/
      //ç³»ç»Ÿæ•°æ®
      barrageArray.forEach(function(item,index){
        createBarrage(item, false);
      });

      //ç‚¹å‡»å‘é€
      sendBtn.onclick = sendMsg;   //ç‚¹å‡»å‘é€

      //å›è½¦
      inputBox.onkeydown = function(e){
        e = e|| window.event;
        if(e.keyCode == 13){
          send();
        }
      }

    })()

    //å…¼å®¹å†™æ³•
    (function() {
        var lastTime = 0;
        var vendors = ['webkit', 'moz'];
        for(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {
            window.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];
            window.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame'] ||    // Webkitä¸­æ­¤å–æ¶ˆæ–¹æ³•çš„åå­—å˜äº†
                                          window[vendors[x] + 'CancelRequestAnimationFrame'];
        }

        if (!window.requestAnimationFrame) {
            window.requestAnimationFrame = function(callback, element) {
                var currTime = new Date().getTime();
                var timeToCall = Math.max(0, 16.7 - (currTime - lastTime));
                var id = window.setTimeout(function() {
                    callback(currTime + timeToCall);
                }, timeToCall);
                lastTime = currTime + timeToCall;
                return id;
            };
        }
        if (!window.cancelAnimationFrame) {
            window.cancelAnimationFrame = function(id) {
                clearTimeout(id);
            };
        }
    }());
</script>
</html>